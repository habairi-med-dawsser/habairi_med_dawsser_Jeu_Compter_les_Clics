<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu - Compter les clics</title>
    <style>
    /* =============================================================
    // 1. BODY & BACKGROUND
    // ============================================================= */
    body {
        font-family: 'Press Start 2P', Arial, sans-serif; /* Police de caract√®re */
        text-align: center; /* Centrer tout le contenu */
        background: linear-gradient(135deg, #1e3c72, #2a5298); /* D√©grad√© de fond sombre/bleu */
        overflow: hidden; /* Emp√™che les barres de d√©filement pour les formes flottantes */
        color: #fff; /* Couleur du texte blanc */
        padding: 30px; /* Marge int√©rieure */
        margin: 0;
        min-height: 100vh;
        position: relative;
    }

    /* Formes flottantes dans le fond (√©l√©ments pseudo) */
    body::before, body::after {
        content: '';
        position: absolute;
        width: 200px;
        height: 200px;
        background: rgba(255,255,255,0.05); /* Cercles transparents */
        border-radius: 50%;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        animation: floatShapes 20s linear infinite alternate; /* Applique l'animation de flottaison */
        z-index: 0; /* Plac√© sous le contenu principal */
    }

    body::after {
        width: 300px;
        height: 300px;
        background: rgba(255,255,255,0.03); /* Deuxi√®me cercle, plus grand et plus transparent */
        animation-duration: 25s; /* Vitesse d'animation diff√©rente */
    }

    /* D√©finition de l'animation pour les formes flottantes */
    @keyframes floatShapes {
        0% { transform: translate(-50%, -50%) rotate(0deg);} /* D√©bute au centre */
        100% { transform: translate(-50%, -60%) rotate(360deg);} /* Flotte l√©g√®rement vers le haut et tourne */
    }

    /* =============================================================
    // 2. HEADER
    // ============================================================= */
    h1 {
        color: #fff; /* Couleur du titre */
        font-size: 3em;
        margin-bottom: 20px;
        text-shadow: 2px 2px 10px rgba(0,0,0,0.6); /* Ombre pour effet 3D */
        animation: fadeIn 1s ease; /* Animation d'apparition */
        position: relative;
        z-index: 2;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-8px); }
        to   { opacity: 1; transform: translateY(0); }
    }

    /* =============================================================
    // 3. LABEL & SELECT (S√©lecteur de dur√©e)
    // ============================================================= */
    label {
        font-size: 18px;
        font-weight: bold;
        color: #ffe600; /* Jaune n√©on */
    }

    /* Style du select */
	select {
		padding: 10px 20px;
		font-size: 16px;
		border-radius: 12px;
		border: none;
		background: linear-gradient(135deg, #ff7eb9, #ff758c);
		color: #fff; /* texte blanc visible */
		font-weight: bold;
		box-shadow: 0 4px 12px rgba(0,0,0,0.3);
		cursor: pointer;
		transition: transform 0.2s, box-shadow 0.3s, background 0.3s;
	}

	/* Au survol du select */
	select:hover {
		transform: scale(1.08);
		box-shadow: 0 6px 18px rgba(0,0,0,0.4), 0 0 15px rgba(255,117,140,0.7);
		background: linear-gradient(135deg, #ff758c, #ff7eb9);
	}

	/* Style des options */
	select option {
		background-color: #2a5298; 
		color: #ffe600; 
		font-weight: bold;
		padding: 5px 10px;
	}

	/* Au survol d'une option  */
	select option:hover {
		background-color: #ff416c; 
		color: #fff; 
	}



    /* =============================================================
    // 4. TIMER & SCORE (Affichage principal)
    // ============================================================= */
    #timer {
        font-size: 24px;
        margin: 15px 0;
        font-weight: 700;
        /* Glow blanc ajout√© au minuteur */
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.8), 1px 1px 6px rgba(0,0,0,0.6); 
        transition: color 0.3s, transform 0.3s;
        position: relative;
        z-index: 2;
    }

    #score, #best {
        font-size: 22px;
        margin: 12px 0;
        font-weight: 700;
        text-shadow: 1px 1px 6px rgba(0,0,0,0.6);
        position: relative;
        z-index: 2;
    }

    /* Couleurs dynamiques du score (Effet n√©on) */
    .score-good { color: #00ff00; text-shadow: 0 0 10px #00ff00; } /* Vert (Performance √©lev√©e) */
    .score-mid { color: #ffcc00; text-shadow: 0 0 10px #ffcc00; } /* Jaune (Performance moyenne) */
    .score-low { color: #ffffff; text-shadow: 0 0 6px #fff; } /* Blanc/Par d√©faut (Performance faible) */

    /* Avertissement du minuteur */
    .timer-warning {
        color: #ff3c00 !important; /* Rouge vif pour l'alerte */
        font-weight: bold;
        animation: blinker 0.5s linear infinite alternate; /* Clignotement */
        text-shadow: 0 0 12px #ff3c00; /* Effet n√©on rouge */
    }
    
    /* D√©finition de l'animation de clignotement */
    @keyframes blinker {
        from { opacity: 1.0; }
        to { opacity: 0.5; }
    }

    /* =============================================================
    // 5. BUTTONS
    // ============================================================= */
    .controls {
        position: relative;
        z-index: 2;
        margin-top: 12px;
    }

    button {
        padding: 14px 28px;
        font-size: 18px;
        margin: 10px;
        cursor: pointer;
        border: none;
        border-radius: 20px;
        background: linear-gradient(135deg, #ff416c, #ff4b2b); /* D√©grad√© */
        color: white;
        font-weight: 700;
        /* Glow n√©on ajout√© au bouton */
        box-shadow: 0 0 10px rgba(255, 65, 108, 0.7), 0 6px 20px rgba(0,0,0,0.5);
        transition: transform 0.1s, background 0.3s, box-shadow 0.3s;
    }

    button:hover {
        transform: scale(1.1); /* Zoom au survol */
        background: linear-gradient(135deg, #ff758c, #ff7eb9); /* Changement de couleur au survol */
        box-shadow: 0 0 15px rgba(255, 117, 140, 0.9), 0 8px 25px rgba(0,0,0,0.6); /* Glow intensifi√© au survol */
    }

    button:active {
        transform: scale(0.95); /* Effet de clic enfonc√© */
        box-shadow: 0 0 30px rgba(255, 65, 108, 1), 0 0 15px rgba(255, 65, 108, 0.5); /* Glow maximal au clic */
    }

    button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
    }

    /* =============================================================
    // 6. TABLE (Meilleurs Scores)
    // ============================================================= */
    table {
        margin: 25px auto; /* Centrage */
        border-collapse: collapse;
        width: 360px;
        font-size: 18px;
        background: rgba(255,255,255,0.05); /* Fond transparent */
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        color: #fff;
        backdrop-filter: blur(6px); /* Effet de flou derri√®re le tableau */
        position: relative;
        z-index: 2;
    }

    th, td {
        border-bottom: 1px solid rgba(255,255,255,0.2); /* S√©parateurs de lignes doux */
        padding: 12px 15px;
        transition: background-color 0.1s; /* Pour l'animation de flash */
    }

    th {
        background: rgba(255,255,255,0.1); /* Fond des en-t√™tes */
        font-weight: bold;
        text-align: left;
    }
    
    /* Effet de flash lors d'un nouveau record */
    .record-flash {
        animation: flash 0.2s 10 alternate; /* Clignote 10 fois (2 secondes au total) */
        background-color: #00ff00 !important; /* Fond */
        color: #000;
        text-shadow: none;
    }

    @keyframes flash {
        from { background-color: rgba(0, 255, 0, 0.8); }
        to { background-color: rgba(0, 255, 0, 0.1); }
    }

    /* =============================================================
    // 7. SCORE ANIMATIONS (PULSATION ET POP-UP +1)
    // ============================================================= */
    
    /* Classe pour d√©clencher l'animation de pulsation */
    .score-pulse {
        animation: pulse 0.3s ease;
    }

    /* D√©finition de l'animation de pulsation */
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }
    
    /* Style pour le pop-up "+1" */
    .click-fx {
        position: absolute;
        font-size: 24px;
        font-weight: bold;
        color: #00ffcc; /
        pointer-events: none; /* Ignorer les clics et rester au-dessus */																				
        animation: floatingText 0.5s ease-out forwards;
        z-index: 100;
        text-shadow: 0 0 8px #00ffcc;
        transform: translate(-50%, -50%); 
    }

    @keyframes floatingText {
        0% { transform: translate(-50%, 0) scale(1); opacity: 1; }
        100% { transform: translate(-50%, -50px) scale(0.5); opacity: 0; } /* Monte et dispara√Æt */
    }

    /* Responsive small screens */
    @media (max-width: 420px) {
        table { width: 92%; }
        h1 { font-size: 1.6rem; }
        button { padding: 10px 16px; font-size: 14px; }
    }

	/* Design du texte explicatif */
	#game-info {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 15px;
    padding: 15px 25px;
    margin: 30px; 
    max-width: 400px;
    text-align: left; /* texte align√© √† gauche */
    font-size: 18px;
    color: #fff;
    text-shadow: 1px 1px 6px rgba(0,0,0,0.6);
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    backdrop-filter: blur(5px);
    position: absolute; /* pour le placer √† gauche */
    top: 50px; /* distance du haut de la page */
    left: 30px; /* distance du bord gauche */
    animation: floatInfo 2s ease-in-out infinite alternate;
	}
    @media (max-width: 600px) {
        #game-info {
            position: static;   /* enl√®ve le positionnement forc√© */
            margin: 20px auto;  /* centre le bloc */
            width: 90%;         /* pour qu‚Äôil prenne bien sa place */
            animation: none;    /* optionnel : √©vite que √ßa flotte sur mobile */
        }
    }




	@keyframes floatInfo {
		0% { transform: translateY(0); }
		100% { transform: translateY(-8px); }
	}

	#game-info h2 {
		font-size: 22px;
		margin-bottom: 10px;
		color: #ffe600; 
		text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
	}
	#game-info p {
		line-height: 1.5;
	}

    </style>
</head>
<body>
    <!-- Titre principal du jeu -->
    <h1>Compter les clics !</h1>

    <!-- S√©lecteur de dur√©e de la partie -->
    <label for="gametime">Dur√©e de la partie: </label>
    <select id="gametime">
        <option value="30">30s</option>
        <option value="20">20s</option>
        <option value="10">10s</option>
    </select>

    <!-- Tableau des meilleurs scores -->
    <table border="1" aria-label="Meilleurs scores">
        <tr><th>Dur√©e</th><th>Meilleur Score:</th></tr>
        <tr><th>30s</th><th id="best30">0</th></tr>
        <tr><th>20s</th><th id="best20">0</th></tr>
        <tr><th>10s</th><th id="best10">0</th></tr>
    </table>

    <!-- Minuteur et score actuel -->
    <p id="timer">Temps Restant: 30s</p>
    <p id="score">Votre Score: 0 clics</p>

    <!-- Boutons pour jouer et rejouer -->
    <div class="controls">
        <button id="btn">Cliquez</button>
        <button id="restart">Rejouer</button>
    </div>

    <!-- Explication simple du jeu -->
    <div id="game-info">
        <h2>üí° Comment jouer ?</h2>
        <p>
            Clique sur le bouton le plus vite possible !<br>
            Chaque clic = un point üñ±Ô∏è‚ö°<br>
            Essaie de battre ton record !
        </p>
    </div>

    <!-- Sons du jeu -->
    <audio id="clickSound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio> 
    <audio id="endSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" preload="auto"></audio>

    <script>
        // =============================================================
        // I. D√âCLARATION DES VARIABLES ET CONSTANTES
        // =============================================================
        const btn = document.getElementById('btn');
        const scoreEl = document.getElementById('score');
        const timerEl = document.getElementById('timer');
        const restart = document.getElementById("restart");
        const gameTimeSel = document.getElementById("gametime");
        const clickSound = document.getElementById("clickSound");
        const endSound = document.getElementById("endSound");
        const TEMPS_AVERTISSEMENT = 5; // Temps (en secondes) √† partir duquel le minuteur clignote.

        let running = false; // Indicateur pour savoir si le jeu est en cours
        let score = 0;
        // R√©cup√®re les meilleurs scores depuis le stockage local (ou 0 par d√©faut)
        let bestScores = {
            30: parseInt(localStorage.getItem("best30"), 10) || 0,
            20: parseInt(localStorage.getItem("best20"), 10) || 0,
            10: parseInt(localStorage.getItem("best10"), 10) || 0
        };
        let timer = null; // Variable pour stocker l'intervalle du minuteur
        let timeLeft = parseInt(gameTimeSel.value, 10) || 30; // Temps restant initial, bas√© sur la s√©lection
        let gameDuration = timeLeft; // Dur√©e totale de la partie s√©lectionn√©e

        // =============================================================
        // II. FONCTIONS DU JEU
        // =============================================================
        /**
         * @function initialiserMeilleursScores
         * Met √† jour l'affichage des meilleurs scores au chargement de la page.
         */
        function initialiserMeilleursScores() {
            document.getElementById("best30").textContent = bestScores[30];
            document.getElementById("best20").textContent = bestScores[20];
            document.getElementById("best10").textContent = bestScores[10];
        }

        /**
         * @function mettreAJourScoreEtEffets
         * Incr√©mente le score, met √† jour l'affichage et applique les effets visuels (pulsation, couleur et pop-up +1).
         */
        function mettreAJourScoreEtEffets(event) {
    // 1Ô∏è‚É£ Incr√©mentation imm√©diate
    score++;
    scoreEl.textContent = "Votre Score: " + score + " clics";

    // 2Ô∏è‚É£ Pulsation du score via reflow isol√©
    scoreEl.classList.add("score-pulse");
    setTimeout(() => scoreEl.classList.remove("score-pulse"), 300); // dur√©e = animation

    // 3Ô∏è‚É£ Pop-up +1 ind√©pendant
    if (event && typeof event.clientX === "number") {
        const clickFX = document.createElement('span');
        clickFX.textContent = "+1";
        clickFX.className = "click-fx"; 
        document.body.appendChild(clickFX);
        clickFX.style.left = event.clientX + 'px';
        clickFX.style.top = event.clientY + 'px';

        // Animation g√©r√©e via CSS, suppression apr√®s
        clickFX.addEventListener('animationend', () => clickFX.remove());
        setTimeout(() => { if (clickFX.parentNode) clickFX.remove(); }, 700);
    }

    // 4Ô∏è‚É£ Couleur dynamique du score
    const bestScoreActuel = bestScores[gameDuration] || 0;
    scoreEl.classList.remove("score-good","score-mid","score-low");
    if(bestScoreActuel > 0){
        const ratio = score / bestScoreActuel;
        if(ratio >= 0.85) scoreEl.classList.add("score-good");
        else if(ratio >= 0.5) scoreEl.classList.add("score-mid");
        else scoreEl.classList.add("score-low");
    } else {
        scoreEl.classList.add("score-low");
    }
}



        /**
         * @function gererMinuteur
         * S'ex√©cute chaque seconde, met √† jour le temps, l'avertissement et v√©rifie la fin de partie.
         */
        function gererMinuteur() {
            if (typeof timeLeft === "undefined" || timeLeft === null) {
                timeLeft = parseInt(gameTimeSel.value, 10) || 30;
            }
            timeLeft--;
            if (timeLeft < 0) timeLeft = 0;
            timerEl.textContent = "Temps Restant: " + timeLeft + " s";
            
            // G√®re l'effet d'avertissement clignotant
            if (timeLeft <= TEMPS_AVERTISSEMENT && timeLeft > 0) {
                timerEl.classList.add("timer-warning");
            } else {
                timerEl.classList.remove("timer-warning");
            }

            if (timeLeft <= 0) {
                terminerPartie();
            }
        }

        /**
         * @function demarrerPartie
         * Initialise la partie et lance le compte √† rebours.
         */
        function demarrerPartie() {
            running = true;
            // D√©sactiver le s√©lecteur de dur√©e pour √©viter de changer le temps en cours de partie
            gameTimeSel.disabled = true; 
            gameDuration = parseInt(gameTimeSel.value, 10) || 30; // Fixe la dur√©e de la partie
            timeLeft = gameDuration;
            // reset score pour nouvelle partie
            score = 0;
            scoreEl.textContent = "Votre Score: " + score + " clics";
            timerEl.textContent = "Temps Restant: " + timeLeft + " s";
            // Clear ancien timer si existant
            clearInterval(timer);
            timer = setInterval(gererMinuteur, 1000);
        }

        /**
         * @function terminerPartie
         * Arr√™te le jeu, d√©sactive le bouton et enregistre le meilleur score.
         */
        function terminerPartie() {
            clearInterval(timer);
            timer = null;
            btn.disabled = true;
            running = false;
            try { endSound.currentTime = 0; endSound.play(); } catch (e) { /* autoplay peut √™tre bloqu√© */ }
            timerEl.classList.remove("timer-warning"); 
            // R√©activer le s√©lecteur de dur√©e
            gameTimeSel.disabled = false;
            
            const finalGameDuration = gameDuration || parseInt(gameTimeSel.value, 10) || 30; 
            
            // V√©rification et enregistrement du meilleur score (avec effet de flash)
            if (score > (bestScores[finalGameDuration] || 0)) {
                bestScores[finalGameDuration] = score;
                localStorage.setItem("best" + finalGameDuration, score);
                
                const bestCell = document.getElementById("best" + finalGameDuration);
                if (bestCell) {
                    bestCell.textContent = score;
                    bestCell.classList.add("record-flash"); // Ajoute la classe de flash
                    
                    // Retire la classe de flash apr√®s 2 secondes
                    setTimeout(() => {
                        bestCell.classList.remove("record-flash");
                    }, 2000);
                }
            }
        }

        /**
         * @function reinitialiserJeu
         * R√©initialise toutes les variables et l'affichage pour une nouvelle partie.
         */
        function reinitialiserJeu() {
            clearInterval(timer);
            timer = null;
            running = false;
            btn.disabled = false;
            // Assurer que le s√©lecteur est actif apr√®s la r√©initialisation
            gameTimeSel.disabled = false; 
            score = 0;
            
            // R√©cup√®re la dur√©e actuelle pour la r√©initialisation
            timeLeft = parseInt(gameTimeSel.value, 10) || 30;
            gameDuration = timeLeft;
            
            // Mise √† jour de l'affichage
            timerEl.textContent = "Temps Restant: " + timeLeft + " s";
            scoreEl.textContent = "Votre Score: " + score + " clics";
            
            // Nettoyage des effets visuels
            timerEl.classList.remove("timer-warning");
            scoreEl.classList.remove("score-good", "score-mid", "score-low");
        }

        // =============================================================
        // III. GESTION DES √âV√âNEMENTS
        // =============================================================

        // 1. Initialisation de l'affichage au chargement
        initialiserMeilleursScores();

        // 2. √âv√©nement de changement de dur√©e
        gameTimeSel.addEventListener('change', () => {
            // Permet de changer la dur√©e uniquement si le jeu n'est pas en cours
            if (!running){
                // Utilise reinitialiserJeu pour mettre √† jour correctement le temps
                reinitialiserJeu(); 
            }
        });

        // 3. √âv√©nement de clic sur le bouton principal
        // L'objet 'event' est maintenant pass√© pour d√©terminer la position du clic
        btn.addEventListener('click', (event) => {
            // Joue le son de clic et le r√©initialise
            try { clickSound.currentTime = 0; clickSound.play(); } catch(e) {}
            
            // Si le jeu n'est pas lanc√©, le d√©marrer
            if (!running){
                demarrerPartie();
            }
            
            // Si le jeu est en cours, mettre √† jour le score
            if (running){
                mettreAJourScoreEtEffets(event);
            }
        });

        // 4. √âv√©nement de clic sur le bouton Rejouer
        restart.addEventListener('click', reinitialiserJeu);

    

    </script>
</body>
</html>